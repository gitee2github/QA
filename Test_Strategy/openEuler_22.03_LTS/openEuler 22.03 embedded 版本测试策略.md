![openEuler ico](../../images/openEuler.png)

版权所有 © 2022 openEuler社区  
您对“本文档”的复制、使用、修改及分发受知识共享(Creative Commons)署名—相同方式共享4.0国际公共许可协议(以下简称“CC BY-SA
4.0”)的约束。为了方便用户理解，您可以通过访问<https://creativecommons.org/licenses/by-sa/4.0/>了解CC BY-SA 4.0的概要 (但不是替代)。CC BY-SA
4.0的完整协议内容您可以访问如下网址获取：<https://creativecommons.org/licenses/by-sa/4.0/legalcode>。

修订记录

| 日期       | 修订版本 | 修改  章节       | 修改描述               | 作者       |
| ---------- | -------- | ---------------- | ---------------------- | ---------- |
| 2022-3-10  | 1.0.0    |            | 初稿                   | saarloos |
| 2022-3-15  | 1.0.1    |            | 修改特性测试策略章节     | xukunkun |
| 2022-3-17  | 1.0.2    |            | 补充树莓派测试的具体内容；调整性能测试内容；修改测试计划章节| xukunkun |


目 录

1 概述 

>   1.1 版本背景

>   1.2 需求范围

2 风险

3 测试分层策略

4 测试分析设计策略

>   4.1 新增feature测试设计策略

>   4.2 继承feature/组件测试设计策略

>   4.3 专项测试策略

5 测试执行策略

6 附件

**Keywords 关键词**：

openEuler embedded 测试策略

Abstract 摘要：

本文是openEuler 22.03 embedded 版本的整体测试策略，用于指导该版本后续测试活动的开展

缩略语清单：

| 缩略语 | 英文全名                             | 中文解释       |
| ------ | ------------------------------------ | -------------- |
| LTS    | Long time support                    | 长时间维护     |
| OS     | Operation System                     | 操作系统       |
| CVE    | Common Vulnerabilities and Exposures | 公共漏洞和暴露 |

# 概述

openEuler Embedded是基于openEuler社区面向嵌入式场景的Linux版本。当前openEuler内核源于Linux实现软实时能力，同时具备soc内多平面混合部署，开放基于Yocto构建包的小型化定制裁剪能力，是由全球开源贡献者构建的高效、稳定、安全的开源操作系统。

本文主要描述openEuler 22.03 embedded 版本的总体测试策略，按照社区开发模式进行运作，结合社区release-manager团队制定的版本计划规划相应的测试活动。整体测试策略覆盖新需求、继承需求的测试分析和执行，明确各个测试周期的测试策略及出入口标准，指导后续测试活动。

## 版本背景

openEuler embedded 22.03 版本是基于22年全新的LTS基线版本的Linux 5.10内核，根据嵌入式设备的特点进行实时能力增强和裁剪，主要功能：

1.  基于Linux内核5.10提供软实时能力
2.  继承鸿蒙分布式软总线，实现openEuler设备间的互联互通
3.  提供soc内实时和非实时多平面混合部署能力
4.  开放基于yocto构建镜像小型化裁剪能力及ARM交叉编译工具链支持
5.  以树莓派4B作为嵌入式标准硬件

## 需求范围

openEuler 22.03 embedded版本交付需求列表如下：

| **no** | **feature**                                                  | **status** | **sig**                 | **owner**                                      |
| ------ | ------------------------------------------------------------ | ---------- | ----------------------- | ---------------------------------------------- |
||基于Linux 5.10内核提供软实时能力|Developing|||
||实现soc内实时和非实时多平面混合部署|Developing|||
||开放基于Yocto构建包的小型化定制裁剪能力|Developing|||
||基于社区10.3版本gcc提供ARM版本交叉编译工具链|Developing|||
||支持树莓派4B作为嵌入式通用硬件|Developing|||
||集成鸿蒙的分布式软总线，实现openEuler设备之间的互联互通|Developing|||

# 风险

| 问题类型 | 问题描述 | 问题等级 | 应对措施 | 责任人 | 状态 |
| -------- | -------- | -------- | -------- | ------ | ---- |
|          |          |          |          |        |      |

# 测试分层策略

本次LTS版本的具体测试分层策略如下：

| **需求**                        | **开发主体**          | **测试主体**      | **测试分层策略**                                             |
| ------------------------------- | --------------------- | ----------------- | ------------------------------------------------------------ |
| 基于Linux 5.10内核提供软实时能力 | sig-yocto | sig-Yocto| 重点对软实时能力进行性能摸底 |
| 实现soc内实时和非实时多平面混合部署 | sig-embedded | sig-embedded | 重点对openAMP通信基础功能进行验证 |
| 开放基于Yocto构建包的小型化定制裁剪能力 | sig-yocto | sig-yocto | 重点对yocto构建、裁剪以及相关资料进行验证 |
| 基于社区10.3版本gcc提供ARM版本交叉编译工具链 | sig-yocto | sig-yocto | 针对交叉编译工具链的可用性进行验证 |
| 支持树莓派4B作为嵌入式通用硬件 | sig-yocto | sig-yocto | 对发布件在树莓派4B上的安装、基础功能、稳定性及新增特性的测试 |
| 集成鸿蒙的分布式软总线，实现openEuler设备之间的互联互通 | sig-embedded | sig-embedded | 对openEuler 22.03 embedded设备间互联互通进行测试 |

# 测试分析设计策略

## 新增feature测试设计策略

| *序号* | *Feature*                    | *重点*                                                       | *设计思路*                                                   | *备注* |
| ------ | ---------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ------ |
| 1 | 基于Linux 5.10内核提供软实时能力 | 内核基础功能及实时性能 | 验证可以通过yocto集成软实时补丁以及基于树莓派4b的性能摸底 | |
| 2 | 实现soc内实时和非实时多平面混合部署 | openAMP通信基础功能和多系统联调 | 验证yocto集成以及基础功能和多平面基础通信能力 | |
| 3 | 开放基于Yocto构建包的小型化定制裁剪能力 | 构建、裁剪、编译工程能力 | 验证根据资料可构建出可自由配置裁剪软件包的基础文件系统 | |
| 4 | 基于社区10.3版本gcc提供ARM版本交叉编译工具链 | 交叉编译工具可用性 | 结合Yocto构建编译以及测试用例编译共同验证 | |
| 5 | 支持树莓派4B作为嵌入式通用硬件 | 支持树莓派部署嵌入式系统发布件 | 验证工程支持构建基本文件系统，提供资料说明如何集成到树莓派 | |
| 6 | 集成鸿蒙的分布式软总线，实现嵌入式设备之间的互联互通 | openEuler embedded设备之间的互联互通 | 验证openEuler embedded设备间的互联互通功能以及嵌入式软总线接口可用性 | |


## 继承feature/组件测试设计策略

从老版本继承的功能特性的测试策略如下：

| Feature/组件                              | 策略                                                         |
| ----------------------------------------- | ------------------------------------------------------------ |
| |  |      
## 专项测试策略

### 安全测试

openEuler作为社区开源版本，在系统整体安全上需要进行保证，以发现系统中存在的安全脆弱性与风险，为版本的安全提供切实的依据，推动产品完成安全问题整改，提高产品的安全。整体安全测试需要覆盖：

1.  linux系统安全配置/权限管理等

2.  特性涉及到的安全需求验证

3.  CVE漏洞/敏感信息/端口矩阵/交付件病毒扫描

4.  白盒安全测试

| 测试类         | 描述                      | 具体测试内容                                                 |
| :------------- | ------------------------- | ------------------------------------------------------------ |
| 安全扫描类     | CVE扫描/敏感信息/编译选项 | 通过工具进行相应的扫描，扫描结果采用增量的方式进行分析；编译选项和敏感信息需要针对新开源特性及新增软件包进行； |
| 安全配置管理类 | Linux安全规范             | Linux安全规范包括：服务管理，账号密码管理、文件及用户权限管理、内核参数配置管理、日志管理等；需对openEuler版本进行上述安全配置测试 |
| 白盒安全测试类 | Fuzz测试                  | Fuzz测试是能发现接口参数类问题和内存相关问题的有效方法，所以需要针对操作系统重点软件包开展fuzz；通过部署kasan版本的内核，进行syzkaller的测试；对重点软件包开展oss-fuzz测试；利用开源测试工具csmith/javafuzzer/jfuzz对对编译器组件进行fuzz测试；虚拟化组件qemu的asan版本开展fuzz测试； |

### 可靠性测试

可靠性是版本测试中需重点考虑的测试活动，在各类资源异常/抢占竞争/压力/故障等背景下，通过功能的并发、反复操作进行长时间的测试；过程中通过监控系统资源、进程运行等状态，及时发现系统/特性隐藏的问题。

可靠性的测试建议从关键特性、重要组件、新增特性的可靠性指标和系统级的可靠性进行分析和设计，已保证特性和系统在各类异常、故障及压力背景下的持续提供服务的能力。

| 测试类性     | 具体测试内容                                                 |
| ------------ | ------------------------------------------------------------ |
| 操作系统长稳 | 系统在各种压力背景下，通过构造资源类和服务类等异常，随机执行LTP、系统管理操作等测试；过程中关注系统重要进程/服务，日志等异常情况；建议稳定性测试时长7\*24 |
| 特性长稳     | 特性级的可靠性，需结合特性涉及和使用的资源类型，如进程、服务、文件、CPU/内存/IO/网络等；通过模拟各类资源异常/竞争/压力故障场景，并发/反复的进行特性提供的基本功能操作 |

### 性能测试

性能测试是针对交付件的具体性能指标，利用工具进行各类性能指标的测试。openEuler Embedded是openEuler社区首次面向嵌入式场景推出的Linux版本，性能指标项和服务器版本对齐，基于开源性能测试工具，形成性能基线；特性类的性能，需要按照各个特性既定的指标，进行时间效率、资源消耗底噪等方面的测试验证，保证指标项与既定目标的一致。

| **指标大项** | **指标小项**                                                                               | **指标值**              | **说明**                          |
|--------------|--------------------------------------------------------------------------------------------|-------------------------|-----------------------------------|
| OS基础性能   | 进程调度子系统，内存管理子系统、进程通信子系统、系统调用、锁性能、文件子系统、网络子系统。 | 首次版本，形成基线 | 首次版本，形成LTS基线，用于后续版本参考 |

### 兼容性测试

南向兼容性测试为整机适配测试。

本次LTS版本的整机兼容性适配测试会从acpi、impi、memory、系统兼容性、CPU特性、kabi规范性、稳定性等方面进行适配，适配完成后将在社区发布本次LTS版本的整机兼容性清单。

整机适配兼容性测试交付清单如下：

| **嵌入式硬件**  | **CPU型号**  | **测试主体** | **测试计划** |
|--|--|--|--|
| 树莓派4B | BCM2711 |  |  |


### 资料测试

资料测试主要是对版本交付的资料进行测试，重点是保证各个资料描述说明的清晰性和功能的正确性，另外openEuler作为一个开源社区，除提供中文的资料还有英文文档也需要重点测试。资料交付清单如下：

| **手册名称**       | **覆盖策略**                                                           | **中英文测试策略** |
|--------------------|------------------------------------------------------------------------|--------------------|
| openEuler Embedded用户指南 | 安装步骤的准确性及各特性使用的正确行 | 英文描述的准确性   |
| openEuler Embedded yocto构建指南啊 | 构建步骤的准确性 | 英文描述的准确性   |


# 测试执行策略

openEuler 22.03 embedded版本按照社区release-manger团队既定的版本计划，共有3轮测试，按照社区研发模式，所有的需求都在拉分支前已完成合入，因此版本测试采取1+1+1的测试方式，即1轮基本功能保障发布beta版本可以提供给外部开发者，1轮全量保障本次版本发布所有特性(新增&继承)以及系统其他dfx能力，1轮回归。

### 测试计划

openEuler 22.03 embedded 版本按照社区开发模式进行运作，结合社区release-manager团队制定的版本计划规划相应的测试活动。供适配开发使用

| Stange name   | Begin time | End time   | Days | Note                          |
| :------------ | :--------- | :--------- | ---- | ----------------------------- |
| Branch        | 2022/1/24  | 2022/1/24  | 1    | 从22.03 LTS-Next拉22.03 LTS版本分支 |
| Build & Alpha | 2022/1/25  | 2022/1/31  | 5    | 版本DailyBuild & 开发自验证   |
| Test round 1  | 2022/3/1   | 2022/3/10  | 10   | 基础OS质量保障和开源软件包功能验证        |
| Test round 2  | 2022/3/11  | 2022/3/20  | 10   | 关键新特性测试设计验证 |
| Test round 3  | 2022/3/21  | 2022/3/30  | 10   | 端到端用户使用场景测试以及回归测试 |

### 测试重点

测试阶段1：

1. 基础OS质量保障：linux系统调用、glibc基本功能测试
2. 基础开源软件包功能验证：存在性、基础功能
3. 专项：
   可靠性：保证版本的长时间稳定运行，建议运行时长7\*24 
   软件包fuzz测试 
   兼容性测试：南向硬件测试+北向软件测试

测试阶段2：

1. 关键新特性的测试验证
2. 基础安全、可靠性、资料测试
   性能测试：形成性能基线
   重启测试

测试阶段3：

1. 端到端用户使用场景测试
2. 社区问题单回归测试

### 入口标准

1.  上个阶段无block问题遗留

2.  转测版本的冒烟无阻塞性问题

### 出口标准

1.  策略规划的测试活动涉及测试用例100%执行完毕

2.  发布特性/新需求/性能基线等满足版本规划目标

3.  版本无block问题遗留，其它严重问题要有相应规避措施或说明

# 附件

无
