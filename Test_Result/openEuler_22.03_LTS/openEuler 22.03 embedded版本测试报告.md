![openEuler ico](../../images/openEuler.png)

版权所有 © 2021  openEuler社区
您对“本文档”的复制、使用、修改及分发受知识共享(Creative Commons)署名—相同方式共享4.0国际公共许可协议(以下简称“CC BY-SA 4.0”)的约束。为了方便用户理解，您可以通过访问[*https://creativecommons.org/licenses/by-sa/4.0/*](https://creativecommons.org/licenses/by-sa/4.0/) 了解CC BY-SA 4.0的概要 (但不是替代)。CC BY-SA 4.0的完整协议内容您可以访问如下网址获取：[*https://creativecommons.org/licenses/by-sa/4.0/legalcode*](https://creativecommons.org/licenses/by-sa/4.0/legalcode)。

修订记录

| 日期       | 修订版本 | 修改章节           | 修改描述   |
| ---------- | -------- | ------------------ | ---------- |
| 2022/03/21 | 1.0.0    | 初始               | saarloos |
| 2022/03/22 | 1.0.1    | 补充测试活动验证情况    | xukunkun |

关键词：

openEuler LTS  embedded  分布式软总线 混合部署 软实时 SDK

摘要：

文本主要描述openEuler 22.03-LTS embedded版本的整体测试过程，详细叙述测试覆盖情况，并通过问题分析对版本整体质量进行评估和总结。

缩略语清单：

| 缩略语      | 英文全名                             | 中文解释       |
| ----------- | ------------------------------------ | -------------- |
| OS          | Operating system                     | 操作系统       |
| raspberrypi | raspberrypi                          | 树莓派         |
| HA          | high availability                    | 高可靠性       |
| LTS         | long time support                    | 长时间维护     |
| CVE         | Common Vulnerabilities and Exposures | 通用漏洞批露   |
| UCE         | uncorrected error                    | 不可纠正的错误 |

---

\***

# 1   概述

openEuler Embedded是基于openEuler社区面向嵌入式场景的Linux版本。当前openEuler内核源于Linux实现软实时能力，同时具备soc内多平面混合部署，开放基于Yocto构建包的小型化定制裁剪能力，是由全球开源贡献者构建的高效、稳定、安全的开源操作系统。

本文主要描述openEuler 22.03 embedded版本的总体测试活动，按照社区开发模式进行运作，结合社区release-manager团队制定的版本计划规划相应的测试计划及活动。测试报告覆盖新需求、继承需求的测试执行情况和评估，并结合各类专项测试活动和版本问题单总体情况进行整体的说明和质量评估。

# 2   测试版本说明

openEuler embedded 22.03 版本是基于22年全新的LTS基线版本的Linux 5.10内核，根据嵌入式设备的特点进行实时能力增强和裁剪，主要功能：

1.  基于Linux内核5.10提供软实时能力
2.  继承鸿蒙分布式软总线，实现openEuler设备间的互联互通
3.  提供soc内实时和非实时多平面混合部署能力
4.  开放基于yocto构建镜像小型化裁剪能力及ARM交叉编译工具链支持
5.  以树莓派4B作为嵌入式标准硬件

openEuler embedded 22.03 版本按照社区release-manager团队的计划，共规划3轮测试，详细的版本信息和测试时间如下表：

| 版本名称                    | 测试起始时间 | 测试结束时间 |
| --------------------------- | ------------ | ------------ |
| openEuler embedded 22.03 RC1 | 2022/3/1   | 2022/3/10   |
| openEuler embedded 22.03 RC2 | 2022/3/11  | 2022/3/20   |
| openEuler embedded 22.03 RC3 | 2022/3/21  | 2022/3/30   |

测试的硬件环境如下：

| 硬件型号                            | 硬件配置信息                                                 | 备注                      |
| ----------------------------------- | ------------------------------------------------------------ | ------------------------- |
| 树莓派4B卡                          | CPU:Cortex-A72 * 4 <br />内存：4GB <br />存储设备：SanDisk Ultra 64GB micro SD |        |
| qemu                          | CPU:Cortex-A57 <br />内存：2GB |        |


openEuler embedded 22.03版本交付需求列表如下：

| **no** | **feature**                                                  | **status** | **sig**                 | **owner**                                      |
| ------ | ------------------------------------------------------------ | ---------- | ----------------------- | ---------------------------------------------- |
| [I4YMW9](https://gitee.com/openeuler/yocto-meta-openeuler/issues/I4YMW9) | 基于Linux 5.10内核提供软实时能力 | Accepted | sig-yocto |  |
| [I4YMUM](https://gitee.com/src-openeuler/OpenAMP/issues/I4YMUM) | 实现soc内实时和非实时多平面混合部署 | Accepted | sig-embedded |  |
| [I4YMUX](https://gitee.com/openeuler/yocto-meta-openeuler/issues/I4YMUX) <br/> [I4Q7W7](https://gitee.com/openeuler/yocto-meta-openeuler/issues/I4Q7W7) | 开放基于Yocto构建包的小型化定制裁剪能力 | Accepted | sig-yocto | |
| [I4YMVX](https://gitee.com/src-openeuler/gcc-cross/issues/I4YMVX) | 基于社区10.3版本gcc提供ARM版本交叉编译工具链 | Accepted | sig-yocto | |
| [I4YMV8](https://gitee.com/openeuler/yocto-meta-openeuler/issues/I4YMV8) | 支持树莓派4B作为嵌入式通用硬件 | Accepted | sig-embedded | |
| [I4YMTP](https://gitee.com/openeuler/dsoftbus_standard/issues/I4YMTP) | 集成鸿蒙的分布式软总线，实现openEuler设备之间的互联互通 | Accepted | sig-yocto | |

本次embedded版本测试活动分工如下：

| **需求**                     | **开发主体**      | **测试主体**      | **测试策略**                                                 |
| ---------------------------- | ----------------- | ----------------- | ------------------------------------------------------------ |
| 基于Linux 5.10内核提供软实时能力 | sig-yocto | sig-Yocto| 重点对软实时能力进行性能摸底 |
| 实现soc内实时和非实时多平面混合部署 | sig-embedded | sig-embedded | 重点对openAMP通信基础功能进行验证 |
| 开放基于Yocto构建包的小型化定制裁剪能力 | sig-yocto | sig-yocto | 重点对yocto构建、裁剪以及相关资料进行验证 |
| 基于社区10.3版本gcc提供ARM版本交叉编译工具链 | sig-yocto | sig-yocto | 针对交叉编译工具链的可用性进行验证 |
| 支持树莓派4B作为嵌入式通用硬件 | sig-yocto | sig-yocto | 对发布件在树莓派4B上的安装、基础功能、稳定性及新增特性的测试 |
| 集成鸿蒙的分布式软总线，实现openEuler设备之间的互联互通 | sig-embedded | sig-embedded | 对openEuler 22.03 embedded设备间互联互通进行测试 |

# 3   版本概要测试结论

openEuler embedded 22.03版本整体测试按照release-manager团队的计划，共完成了一轮基础功能测试+一轮新特性专项测试+一轮回归测试；其中第一轮基础功能测试聚焦在linux系统调用、glibc和基础软件包功能的自动化验证；另外一轮新特性测试开展版本交付的所有特性和各类专项测试，另外开展安全CVE扫面及OS基础性能摸底和系统整体集成验证，旨在识别阻塞性问题；一轮回归测通过自动化测试重点覆盖问题单较多模块的覆盖和扩展测试，验证问题的修复和影响程度；版本按照测试策略完成了全量功能验证和专项测试(性能、可靠性、兼容性、安全)，所有测试预计发布前按计划完成。本版本计划交付需求6个，实际交付6个，交付率100%，所有发布需求均验证通过。

​openEuler embedded 22.03版本共发现问题22个，有效问题15个，遗留问题2个(详见遗留问题章节)，其他问题均已修复，回归测试结果正常。版本整体质量较好。

# 4   版本详细测试结论

22.03 版本详细测试内容包括：

1、完成基础OS质量保障，包括内核、系统调用、glibc以及80款基础软件包的功能测试；

2、对关键特性，如软实时能力、分布式软总线、yocto小型定制裁剪以及混合部署进行了专项特性测试；

3、其他专项测试包括性能专项、安全专项、兼容性测试以及可靠性测试；


## 4.1   特性测试结论

### 4.1.1   继承特性评价

对产品所有继承特性进行评价，用表格形式评价，包括特性列表（与特性清单保持一致），验证质量评估

| 序号 | 组件/特性名称                             |        特性质量评估        | 备注                                                                                                                   |
| ---- | ----------------------------------------- | :-------------------------: | ---------------------------------------------------------------------------------------------------------------------- |
| | | |

### 4.1.2   新需求评价

建议以表格的形式汇总新特性测试执行情况及遗留问题单情况的评估,给出特性质量评估结论。

| **序号** | **特性名称**                 | **测试覆盖情况**                                             | **约束依赖说明** | **遗留问题单** | **质量评估**               | **备注<img width=50/>**                                      |
| -------- | ---------------------------- | ------------------------------------------------------------ | ---------------- | -------------- | -------------------------- | ------------------------------------------------------------ |
| 1        | 基于Linux 5.10内核提供软实时能力 |  在标准镜像的基础上集成软实时补丁，通过yocto构建出RT镜像，在树莓派4b上部署，使用cyclictest开源工具进行性能测试，测得中断加调度的平均时延在8us | 不正式发布RT镜像，提供工程构建指导 | NA             | <font color=blue>█</font>  |                                   |
| 2        | 实现soc内实时和非实时多平面混合部署 | 验证发布件内提供了混合部署的功能库，通过用户手册完成了实时和非实时多平面混合部署，实现了openEuler Embedded对zephyr的生命周期管理和基本通信 | NA               | NA             | <font color=blue>▲</font>  |  |
| 3        | 开放基于Yocto构建包的小型化定制裁剪能力 | 使用yocto的packagegroup类对openeuler的发布包按类型进行分组，便于在image和sdk中添加包 |   | NA             | <font color=green>█</font> |             |
| 4        | 基于社区10.3版本gcc提供ARM版本交叉编译工具链 | 发布件中包含该工具，交叉编译功能在测试活动中已验证 | NA               | NA             | <font color=green>█</font> |                                                              |
| 5        | 支持树莓派4B作为嵌入式通用硬件 | 树莓派部署、基本OS质量已覆盖，用户可通过资料完成树莓派上镜像的构建、部署和基本使用 | 不直接发布树莓派的部署件，但工程支持构建基本文件系统，提供资料说明如何集成到树莓派 | NA             | <font color=green>█</font> |                                                              |
| 6        | 集成鸿蒙的分布式软总线，实现openEuler设备之间的互联互通 | 在标准以太网的连接方式下，测试了两台嵌入式设备间的发现、连接和传输的API接口，验证了不同设备间基于dsoftbus通信的互通互联 | 对外发布二进制、软总线功能库集合以及使用资料 | NA  | <font color=green>█</font> |                                                              |

<font color=red>●</font>： 表示特性不稳定，风险高

<font color=blue>▲</font>： 表示特性基本可用，遗留少量问题

<font color=green>█</font>： 表示特性质量良好

## 4.2   兼容性测试结论

### 4.2.1   升级兼容性

openEuler embedded 22.03作为首个嵌入式版本不涉及升级兼容性测试

### 4.2.2   南向兼容性

南向兼容性仅对树莓派4B进行测试

下表列出版本集成验证中涉及的硬件整机信息：

| 硬件型号              | 硬件详细信息                                                                                          |
| --------------------- | ----------------------------------------------------------------------------------------------------- |
| 树莓派4B卡                          | CPU:Cortex-A72 * 4 <br />内存：4GB <br />存储设备：SanDisk Ultra 64GB micro SD |        |


### 4.2.3   北向兼容性

openEuler embedded 22.03作为首个嵌入式版本不涉及兼容性测试

## 4.3   专项测试结论

### 安全测试

整体安全测试覆盖：

1、Linux系统安全配置管理类主要包括：服务管理、账号密码管理、文件及用户权限管理、内核参数配置管理、日志管理等进行全量测试

2、通过工具进行CVE漏洞/敏感信息/端口矩阵/编译选项扫描/交付件病毒扫描

3、针对安全加固指南中的加固项，进行全量测试。

整体OS安全测试较充分，风险可控。

### 可靠性测试

| 测试类型     | 测试内容                                                                               | 测试结论                   |
| ------------ | -------------------------------------------------------------------------------------- | -------------------------- |
| 操作系统长稳 | 系统在各种压力背景下，随机执行LTP等测试；过程中关注系统重要进程/服务、日志的运行情况； | 操作系统稳定运行7*24小时   |
| 断电重启测试 | 系统通过各种复位命令重启，包括系统调用复位重启、咬狗重启、panic重启，各执行100次 | 系统可以正常重启   |

### 性能测试

| **指标大项 ** | **指标小项**                                                 | **指标值**                        | 测试结论                 |
| ------------- | ------------------------------------------------------------ | --------------------------------- | ------------------------ |
| OS基础性能    | 进程调度子系统，内存管理子系统、进程通信子系统、系统调用、锁性能、文件子系统、网络子系统。 |  |  |
| 特性性能      | 软实时性能：xx |   |   |

# 5   问题单统计

openEuler 22.03 embedded版本共发现问题单22个，有效问题18个，其中修复问题单16个，回归均通过。详细分布见下表:

| 测试阶段                    | 问题单数 |
| --------------------------- | -------- |
| openEuler embedded RC1 | xx       |
| openEuler embedded RC2 | xx       |
| openEuler embedded RC3 | xx       |

整体看版本问题单收敛趋势明显。

# 6   附件

## 遗留问题列表

| 序号 | 问题单号 | 问题简述                                                     | 问题级别 | 影响分析                                                     | 规避措施 |
| ---- | -------- | ------------------------------------------------------------ | -------- | ------------------------------------------------------------ | -------- |
| 1 |  |  |  |  |  |

