![openEuler ico](../../images/openEuler.png)

版权所有 © 2021  openEuler社区
 您对“本文档”的复制、使用、修改及分发受知识共享(Creative Commons)署名—相同方式共享4.0国际公共许可协议(以下简称“CC BY-SA 4.0”)的约束。为了方便用户理解，您可以通过访问[https://creativecommons.org/licenses/by-sa/4.0/](https://creativecommons.org/licenses/by-sa/4.0/)了解CC BY-SA 4.0的概要 (但不是替代)。CC BY-SA 4.0的完整协议内容您可以访问如下网址获取：[https://creativecommons.org/licenses/by-sa/4.0/legalcode。](https://creativecommons.org/licenses/by-sa/4.0/legalcode。)

修订记录

|日期|修订版本|修改描述|作者|
|:----|:----|:----|:----|
|2021-3-22|1|初稿|苑露露|



关键词：

openEuler内核热替换特性测试报告

摘要：

openEuler的内核热替换特性通过快速重启内核和程序热迁移实现，NVWA是实现内核热替换的自动化工具。


# 1 特性概述

openEuler的内核热替换特性支持业务不中断情况下实现内核热替换
- 内核热替换：启动加速实现内核的快速替换
- 程序热迁移：在内核替换前dump程序状态，并在内核启动后快速恢复进程状态以实现业务不中断

# 2 特性测试信息

本节描述被测对象的版本信息和测试的时间及测试轮次，包括依赖的硬件。

|版本名称|测试起始时间|测试结束时间|
|:----|:----|:----|
|openEuler 21.03 RC2<br>（内核热替换 kexec测试）|2021.3.3|2021.3.15|
|openEuler 21.03 RC3<br> (nvwa测试)|2021.3.15|2021.3.21|
|openEuler 21.03 RC4<br> (回归测试)|2021.3.22|2021.3.22|

描述特性测试的硬件环境信息

|硬件型号|硬件配置信息|备注|
|:----|:----|:----|
|虚拟机|4U4G|arm架构|

# 3 测试结论概述

## 3.1 测试整体结论

nvwa在 openEuler21.03 版本，共计执行用例49个，主要覆盖了基本功能测试、可靠性测试、安全测试以及压力测试。发现问题12个，剩余一个issue在解决中，风险较低。

|测试活动|活动评价|
|:----|:----|
|功能测试|覆盖基本功能流程、命令行接口、配置文件测试，用例32全部通过，功能符合预期|
|可靠性测试|覆盖进程状态异常，执行流程异常测试，用例7个全部通过，表现稳定|
|安全测试|配置文件与执行文件权限测试，用例1个通过，符合安全最小权限|
|压力测试|覆盖系统压力测试、反复执行内核热替换，用例9个全部通过，符合预期|

## 3.2   约束说明

- nvwa需要关闭selinux
- nvwa日志记录在log_dir中，此处作为保留项，暂未实现
- 只支持arm架构


## 3.3   遗留问题分析

### 3.3.1 遗留问题影响以及规避措施

|issue|描述|级别|影响和规避措施|当前状态|
|:----|:----|:----|:----|:----|
|1|nvwa init只删除本次失败现场信息; nvwa包卸载时不会删除失败现场信息|低|日志残留|解决中|

### 3.3.2 问题统计

|    |问题总数|严重|主要|次要|不重要|
|:----|:----|:----|:----|:----|:----|
|数目|12|0|2|10|    |
|百分比|100|0|16.7|83.3|    |

# 4 测试执行

## 4.1 测试执行统计数据

*本节内容根据测试用例及实际执行情况进行特性整体测试的统计，可根据第二章的测试轮次分开进行统计说明。*

|版本名称|测试用例数|用例执行结果|发现问题单数|
|:----|:----|:----|:----|
|openEuler-21.03-RC2|25PASS+2FAIL|2|
|openEuler-21.03-RC3|37PASS+9FAIL|9|
|openEuler-21.03-RC4|48PASS+1FAIL|1|

## 4.2 后续测试建议

1. 关注可靠性测试和故障注入场景
2. 考虑长稳压力测试

# 5 附件

*N/A*

