![openEuler ico](../../images/openEuler.png)

版权所有 © 2022  openEuler社区
您对“本文档”的复制、使用、修改及分发受知识共享(Creative Commons)署名—相同方式共享4.0国际公共许可协议(以下简称“CC BY-SA 4.0”)的约束。为了方便用户理解，您可以通过访问[*https://creativecommons.org/licenses/by-sa/4.0/*](https://creativecommons.org/licenses/by-sa/4.0/) 了解CC BY-SA 4.0的概要 (但不是替代)。CC BY-SA 4.0的完整协议内容您可以访问如下网址获取：[*https://creativecommons.org/licenses/by-sa/4.0/legalcode*](https://creativecommons.org/licenses/by-sa/4.0/legalcode)。

修订记录

| 日期       | 修订版本 | 修改章节           | 修改描述   |
| ---------- | -------- | ------------------ | ---------- |
| 2022/09/14 | 初稿 | 填写模板 | @saarloos |

关键词：

openEuler embedded raspberrypi 分布式软总线 混合部署

摘要：

文本主要描述openEuler embedded 22.09 版本的整体测试过程，详细叙述测试覆盖情况，并通过问题分析对版本整体质量进行评估和总结。


# 1   概述

openEuler Embedded是基于openEuler社区面向嵌入式场景的Linux版本，旨在成为一个高质量的以Linux为中心的嵌入式系统软件平台。

本文主要描述openEuler 22.09 embedded版本的总体测试活动，按照社区开发模式进行运作，结合社区release-manager团队制定的版本计划规划相应的测试计划及活动。测试报告覆盖新需求的测试执行情况和评估，并结合各类专项测试活动和版本问题单总体情况进行整体的说明和质量评估。

# 2   测试版本说明

openEuler embedded 22.09版本是22年首个创新版本，对22.03版本构建、使用上的问题进行了重构，并跟随社区对基础软件包版本进行升级，同时对分布式软总线和混合部署能力进行了增强。主要变更功能如下：

1. yocto构建系统重构，方便后续第三方软件的引入
2. 分布式软总线能力增强，增加树莓派Wifi的组网支持以及对openHarmony设备间的通信能力
3. 多平面混合部署能力增加，增加对树莓派设备的支持，实现在qemu/树莓派上实时OS拉起、结束和再拉起的生命周期管理；实现文件系统和串口服务化部署功能
4. openEuler支持硬实时系统，提供硬实时级别的OS能力，支持硬中断管理、轻量级任务能力

openEuler 22.09 版本按照社区release-manager团队的计划，共规划5轮测试，详细的版本信息和测试时间如下表：

| 版本名称                 | 测试起始时间 | 测试结束时间 |  持续时间 | 备注                          |
| :------------ | :--------- | :--------- | ---- | ----------------------------- |
| Test round 1 (计划)  | 2022/8/22  | 2022/8/28  | 7    | 版本启动测试              |
| Test round 1 (实际)  | 2022/8/24(延期2天)  | 2022/9/3  | 10    | 基础测试、外围包测试、与第二轮测试内容不同所以时间上有交叉 |
| Test round 2 (计划) | 2022/8/29  | 2022/9/4   | 7    | 版本全量集成测试  |
| Test round 2 (实际)  | 2022/9/1(延期2天)  | 2022/9/5   | 4   | 安全配置、基础命令  |
| Test round 3 (计划)  | 2022/9/6   | 2022/9/11  | 7    |  |
| Test round 3 (实际) | 2022/9/6   | 2022/9/12  | 8    | 全量测试   |
| Test round 4 (计划) | 2022/9/12  | 2022/9/15  | 4    | 回归测试      |
| Test round 4 (实际) | 2022/9/13(延期1天) | 2022/9/18  | 6    | 第一轮回归测试、资料测试 |
| Test round 5 (计划) | 2022/9/16  | 2022/9/19  | 4    | 第二轮回归测试     |
| Test round 5 (实际) | 2022/9/19(延期3天)  | 2022/9/24  | 7    | 第二轮回归测试 |

测试的硬件环境如下：

| 硬件型号 | 硬件配置信息 | 备注 |
| ----------------------------------- | ------------------------------------------------------------ | ------------------------- |
| 树莓派4B卡 | CPU:BCM2711(Cortex-A72 * 4) <br />内存：4GB/8GB <br />存储设备：SanDisk Ultra 64GB micro SD |        |
| qemu | CPU:Cortex-A15/A57 <br /> 最小启动内存：512M |        |
| 江苏润和-Hi3561DV300-HiSpark Ai Camera开发套件 | CPU:Hi3561| 仅用于分布式软总线与openEuler组网、通信测试 |
| STM32F407开发板 | CPU:STM32F407| 仅用于硬实时性能的测试 |

openEuler 22.09版本交付[需求列表](https://gitee.com/openeuler/release-management/blob/master/openEuler-22.09/release-plan.md)，其中嵌入式需求如下：

|no|feature|status|sig|owner|发布方式|涉及软件包列表|
|:----|:---|:---|:--|:----|:----|:----|
|[I5G7WM](https://gitee.com/openeuler/yocto-meta-openeuler/issues/I5G7WM)|混合关键部署技术|Developing|sig-yocto|[@linzichang](https://gitee.com/linzichang) [@beiling.xie](https://gitee.com/beilingxie) [@zhengjunling](https://gitee.com/junling_zheng) [@ilisimin](https://gitee.com/open_euler/dashboard/members/ilisimin) [@任慰](https://gitee.com/open_euler/dashboard/members/vonhust)| 源码 + 镜像包含 | dsoftbus_standard, libCoAP, yocto-embedded-tools, yocto-meta-openeuler |
|[I5G7UI](https://gitee.com/openeuler/yocto-meta-openeuler/issues/I5G7UI)|基于分布式软总线扩展生态互联互通|Developing|sig-yocto|[@linzichang](https://gitee.com/linzichang) [@beiling.xie](https://gitee.com/beilingxie) [@zhengjunling](https://gitee.com/junling_zheng) [@ilisimin](https://gitee.com/open_euler/dashboard/members/ilisimin) [@任慰](https://gitee.com/open_euler/dashboard/members/vonhust)| 源码 + 镜像包含 | libmetal, OpenAMP, yocto-embedded-tools, yocto-meta-openeuler |
|[I5OYAM](https://gitee.com/openeuler/UniProton/issues/I5OYAM)|openEuler支持硬实时系统|Developing|sig-embedded|[@linzichang](https://gitee.com/linzichang) [@beiling.xie](https://gitee.com/beilingxie) [@wl1587](https://gitee.com/wl1587) [@任慰](https://gitee.com/open_euler/dashboard/members/vonhust)| 源码 | UniProton |


> 当前社区嵌入式release发布基于qemu的基础标准镜像，嵌入式构建源码在gitee仓库提供。 

本次版本测试活动分工如下：

| **需求**                        | **开发主体**          | **测试主体**      | **测试分层策略**                                             |
| ------------------------------- | --------------------- | ----------------- | ------------------------------------------------------------ |
| 混合关键部署技术 | sig-yocto | sig-Yocto | 测试混合关键部署技术开放接口api，新增的串口/SHELL服务，混合部署生命周期管理以及在树莓派上的混合部署 |
| 基于分布式软总线扩展生态互联互通 | sig-yocto | sig-yocto | 测试分布式软总线开放接口api，重点关注本次新增适配的认证模块，验证与openHarmony的互相识别和通信 |
| openEuler支持硬实时系统 | sig-embedded | sig-embedded | 测试硬实时源码编译、运行及在STM32F407硬件上的实时性能 |

# 3 版本概要测试结论

openEuler embedded 22.09版本整体测试按照release-manager团队的计划，共完成了五轮测试，包含一轮基础及基础软件外围包测试、一轮安全配置及基础OS指令测试、一轮全量测试(基础功能及指令、新增特性、外围包、安全专项、性能专项)以及两轮回归测试；

其中一轮基础功能测试聚焦在linux系统调用、glibc和基础软件外围包功能的自动化验证，旨在识别阻塞性问题；一轮安全配置及基础OS指令测试开展系统安全配置及OS基础指令的测试；另外一轮全量测试，涵盖基础功能及指令、外围包、新增特性、安全专项、性能专项等全面的测试以及用户使用场景测试模拟社区用户，按照使用指南中指导完成了镜像获取启动、基于SDK的应用开发以及容器构建环境的获取和一键构建；最后两轮回归测通过自动化测试重点覆盖问题单较多模块的覆盖和扩展测试，验证问题的修复和影响程度；

版本按照测试策略完成了全量功能验证和专项测试(性能、可靠性、兼容性、安全)，所有测试预计发布前按计划完成。本版本计划交付需求2个，实际交付2个，交付率100%，所有发布需求均验证通过。

​openEuler embedded 22.09版本目前共发现问题73个，修复问题62个，待修复问题9个，预计版本发布前完成修复，暂无遗留问题，版本整体质量较好，风险可控。

# 4 版本详细测试结论

22.09 版本详细测试内容包括：

1. 完成基础OS质量保障，包括内核、系统调用、glibc以及基础软件包的功能测试，测试功能正常，问题已跟踪闭环；
2. 对关键继承特性，如软实时、yocto小型定制裁剪以及ARM版本交叉编译工具链进行了专项特性测试，软实时特性功能正常，性能与2203版本持平，yocto小型定制裁剪以及ARM版本交叉编译工具链功能正常与2203版本使用使用有优化，测试中发现的问题已跟踪闭环
3. 完成各项专项测试 (性能、可靠性、兼容性、安全)，测试正常，问题已跟踪闭环；
4. 对新增特性，针对原有继承部分和新增部分进行了测试，继承功能征程，新增功能征程，问题已跟踪闭环；


## 4.1   特性测试结论

### 4.1.1   继承特性评价

<!-- 对产品所有继承特性进行评价，用表格形式评价，包括特性列表（与特性清单保持一致），验证质量评估 -->

| 序号 | 组件/特性名称 | 特性质量评估 | 备注 |
| ---- | ----------------------------------------- | :-------------------------: | ---------------------------------------------------------------------------------------------------------------------- |
| 1        | 集成openEuler社区软实时补丁 | <font color=green>█</font>  |  |
| 2        | 开放基于Yocto构建包的小型化定制裁剪能力 | <font color=green>█</font> |             |
| 3        | 基于社区10.3版本gcc提供ARM版本交叉编译工具链 | <font color=green>█</font> |  仅验证可用性 |
| 4        | 支持树莓派4B作为嵌入式通用硬件 | <font color=green>█</font> |    |

> Ps: 继承特性中分布式软总线与混合部署，这两个特性与新增需求一同测试，结论在新需求总，不在继承特性中单独列出。

<font color=red>●</font>： 表示特性不稳定，风险高

<font color=blue>▲</font>： 表示特性基本可用，遗留少量问题

<font color=green>█</font>： 表示特性质量良好

### 4.1.2   新需求评价

建议以表格的形式汇总新特性测试执行情况及遗留问题单情况的评估,给出特性质量评估结论。

| **序号** | **特性名称** | **测试覆盖情况** | **约束依赖说明** | **遗留问题单** | **质量评估** | **备注<img width=50/>** |
| -------- | ---------------------------- | ------------------------------------------------------------ | ---------------- | -------------- | -------------------------- | ------------------------------------------------------------ |
| 1 | 混合关键部署技术 | 测试了openamp_init、openamp_deinit、send_message、receive_message四个接口，通过Linux shell命令行访问Client OS，测试服务化串口功能 | 当前版本混合部署特性在qemu和树莓派上支持 | 0  | <font color=green>█</font> | |
| 2 | 基于分布式软总线扩展生态互联互通 | |  |   |  |  |
| 3 | openEuler支持硬实时系统 | 测试了硬实时系统的编译以及适配后的RhealStone性能测试，上下文切换时延2us，中断时延1us | 基于STM32F704硬件，适配后的RhealStone用例测试 |   | <font color=green>█</font> |  |

<font color=red>●</font>： 表示特性不稳定，风险高

<font color=blue>▲</font>： 表示特性基本可用，遗留少量问题

<font color=green>█</font>： 表示特性质量良好

## 4.2   兼容性测试结论

### 4.2.1   升级兼容性

openEuler embedded 均采用断电烧写进行升级，目前不涉及升级兼容性。

### 4.2.2   南向兼容性

openEUler embedded 2209 与2203版本支持硬件无差别，已测试兼容

下表列出版本集成验证中涉及的硬件整机信息：

| 硬件型号 | 硬件详细信息 |
| --------------------- |------------------------------------------------------------------------------------ |
| 树莓派4B卡 | CPU:Cortex-A72 * 4 <br />内存：4GB/8GB <br />存储设备：SanDisk Ultra 64GB micro SD |

### 4.2.3   北向兼容性

创新版本北向兼容性暂不考虑进行测试

## 4.3   专项测试结论

### 安全测试

整体安全测试覆盖：

1、Linux系统安全配置管理类主要包括：服务管理、账号密码管理、文件及用户权限管理、内核参数配置管理、日志管理等进行全量测试，发现5个相关问题，所有问题均澄清或修改。

2、通过工具进行CVE漏洞/敏感信息/端口矩阵/编译选项扫描/交付件病毒扫描，其中发现新增CVE漏洞18个，已提交社区issue，存在异常开启TCP/UDP端口，已提交issue，待修复，编译选项扫描存在部分软件未开启安全编译选项，已提交issue，待修复，敏感信息扫描已确认无敏感信息，交付件无病毒。

3、针对安全加固指南中的加固项，进行全量测试，其中发现问题11个，问题均澄清和修复。

整体OS安全测试较充分，风险可控。

### 可靠性测试

| 测试类型 | 测试内容 | 测试结论 |
| ------- | ------------------------------------------------------------------------------ | -------------------------- |
| 操作系统长稳 | 系统在各种压力背景下，随机执行LTP等测试；过程中关注系统重要进程/服务、日志的运行情况； |  目前稳定运行7天  |


### 性能测试

| **指标大项** | **指标小项** | **指标值** | **测试结论** |
| ------------- | ------------------------------------------------------------ | --------------------------------- | -------------------- |
| OS基础性能 | UnixBench除C编译外测试内容 | 参考22.03 LTS版本相应指标基线 | 比较前一版本差异在5%以内 |
| 软实时补丁性能 | cyclictest空载及压力负载 | 参考22.03 LTS版本相应指标基线 | 比较前一版本持平 |
| 硬实时系统性能 | 适配后的RhealStone用例测试 | 首次形成己先 |  |

# 5   问题单统计

openEuler 22.09 embedded版本共发现问题单92个，拒绝问题单2个，取消问题单5个，其中修复问题单84个，遗留问题单1个，其余回归均通过。详细分布见下表:

| 测试阶段                    | 问题单数 |
| --------------------------- | -------- |
| openEuler embedded RC1 | 36  |
| openEuler embedded RC2 | 19   |
| openEuler embedded RC3 | 25  |
| openEuler embedded RC4 | 6  |
| openEuler embedded RC5 | 6  |

1、RC1 RC2为操作系统基础测试、外围包、基础命令及安全加固测试，主要聚焦于操作系统的基础功能及基本安全问题，由于2209重构了2203的编译系统，测试发现问题数较多，问题主要问题集中于对于系统或外围包的编译配置导致的命令缺失及安全加固配置的缺失；

2、RC3进行了全量测试，问题主要集中在性能、安全编译选项、安全配置、敏感词、CVE等专项测试问题

3、RC4经过了RC3的全量测试，此轮为回归测试，对前面发现问题较多的外围包、安全配置等进行了回归测试，问题发现较少，同时对版本资料进行了测试，发现少量问题。

4、RC5为第二轮回归测试，主要对资料、基础功能以及版本新特性进行回归测试，大部分为资料问题，均修复。

5、版本测试发现问题整体呈收敛


# 6   附件

## 遗留问题列表

| 序号 | 问题单号 | 问题简述 | 问题级别 | 影响分析 | 规避措施 | 历史发现场景 |
| ---- | ------- | -------- | -------- | ------- | -------- | --------- | 
|   1   |     [I5QWBX](https://gitee.com/openeuler/yocto-meta-openeuler/issues/I5QWBX)    |     CVE-2020-36477    |     次要    |      openHarmony第三方库CVE跟随openHarmony修复计划同步，openHamony正在修复中    |     无    |      无       |


# 致谢
非常感谢以下开发者在openEuler 22.09 版本测试中做出的贡献,以下排名不分先后
[seven](xxxx)
[WindDD_2022](xxxx)
[hhm666](xxxx)
[pangkailin](xxxx)
[薛定谔猫的黎曼猜想](xxxx)
[lmq9671](xxxx)
[s_c_c](xxxx)
[saarloos](xxxx)