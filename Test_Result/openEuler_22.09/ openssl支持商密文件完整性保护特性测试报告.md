![openEuler ico](../../images/openEuler.png)


版权所有 © 2022  openEuler社区
 您对“本文档”的复制、使用、修改及分发受知识共享(Creative Commons)署名—相同方式共享4.0国际公共许可协议(以下简称“CC BY-SA 4.0”)的约束。为了方便用户理解，您可以通过访问https://creativecommons.org/licenses/by-sa/4.0/ 了解CC BY-SA 4.0的概要 (但不是替代)。CC BY-SA 4.0的完整协议内容您可以访问如下网址获取：https://creativecommons.org/licenses/by-sa/4.0/legalcode。

修订记录

| 日期 | 修订   版本 | 修改描述 | 作者 |
| ---- | ----------- | -------- | ---- |
| 2022年9月6日 | 初稿 | openssl支持商密文件完整性保护 测试报告 | 王亭亭 |

 关键词： 文件完整性保护, 商密

 

摘要：

 

缩略语清单：

| 缩略语 | 英文全名 | 中文解释 |
| ------ | -------- | -------- |
|        |          |          |
|        |          |          |

# 1     特性概述

IMA全称Integrity Measurement Architecture，是Linux内核提供的强制访问控制子系统，通过在文件访问系统调用添加检查hook，实现文件的完整性度量/校验。
目前openssl新增内核完整性度量架构（IMA/EVM）支持SM3摘要算法和SM2证书，主要支持以下两个场景：原生IMA和IMA摘要列表模式。

# 2     特性测试信息

本节描述被测对象的版本信息和测试的时间及测试轮次，包括依赖的硬件。

| 版本名称 | 测试起始时间 | 测试结束时间 |
| -------- | ------------ | ------------ |
| openEuler 22.09 RC3 |	2022-08-23 | 2022-08-29 |


# 3     测试结论概述

## 3.1   测试整体结论

openssl支持商密文件完整性保护，共计执行40个用例，主要覆盖了：
1、原生IMA度量模式、评估模式（hash）、评估模式（签名）支持商密算法，实现文件完整性保护测试；
2、IMA摘要列表评估模式、IMA摘要列表度量模式支持商密算法，实现文件内容与扩展属性的完整性保护测试；gen_digest_lists命令支持生成SM3摘要列表测试，以及手动/自动导入/删除摘要列表测试；evmctl save命令功能测试；运行度量测试、受保护文件的攻击篡改测试；自定义IMA策略导入及生效测试；各种内核策略模式和内核参数组合测试；
3、轻量级入侵检测AIDE支持商密算法，检测被保护文件变化测试。

综上，整体质量良好。

## 3.2   约束说明

1. 对于每一个在IMA防护范围内的文件，都需要选择使用hash模式和签名模式其中之一的方法标记完整性信息。一般情况下，对于可能发生变化的文件（如数据文件、配置文件等）采用hash模式标记，对于不会发生变化的文件（如可执行文件、动态链接库等）采用签名模式标记；
2. openEuler默认提供的摘要列表中使用的哈希算法为SHA256。当IMA摘要列表度量算法配置为SM3算法时，必须将/etc/ima/digest_lists目录下的摘要列表移除，然后重新生成并签名，否则会导致文件完整性校验错误；
3. 对于openEuler发布的软件包，会默认提供IMA摘要列表文件。由于默认提供的摘要算法为sha256，因此当摘要算法切换为SM3时，会导致openEuler发布的摘要列表无法被导入，在软件包安装过程中可能出现提示信息Cannon parse /etc/ima/digest_lists/0-metadata_list-rpm-......。


## 3.3   遗留问题分析

### 3.3.1 遗留问题影响以及规避措施

| 问题单号 | 问题描述 | 问题级别 | 问题影响和规避措施 | 当前状态 |
| -------- | -------- | -------- | ------------------ | -------- |
| |  |  |  |  |

### 3.3.2 问题统计

|        | 问题总数 | 严重 | 主要 | 次要 | 不重要 |
| ------ | -------- | ---- | ---- | ---- | ------ |
| 数目   |  2 | 0 | 1 | 1 | 0 |
| 百分比 |  100%  | 50% | 50% | 0% |   0%   |

# 4     测试执行

## 4.1   测试执行统计数据

*本节内容根据测试用例及实际执行情况进行特性整体测试的统计，可根据第二章的测试轮次分开进行统计说明。*

| 版本名称 | 测试用例数 | 用例执行结果 | 发现问题单数 |
| -------- | ---------- | ------------ | ------------ |
| openEuler 22.09 RC1 |  40  |  失败2个 |  2个   |

*数据项说明：*

*测试用例数－－到本测试活动结束时，所有可用测试用例数；*

*发现问题单数－－本测试活动总共发现的问题单数。*


 