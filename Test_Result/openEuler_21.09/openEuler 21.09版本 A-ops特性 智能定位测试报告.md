![openEuler ico](../../images/openEuler.png)

版权所有 © 2021  openEuler社区
 您对“本文档”的复制、使用、修改及分发受知识共享(Creative Commons)署名—相同方式共享4.0国际公共许可协议(以下简称“CC BY-SA 4.0”)的约束。为了方便用户理解，您可以通过访问[*https://creativecommons.org/licenses/by-sa/4.0/*](https://creativecommons.org/licenses/by-sa/4.0/) 了解CC BY-SA 4.0的概要 (但不是替代)。CC BY-SA 4.0的完整协议内容您可以访问如下网址获取：[*https://creativecommons.org/licenses/by-sa/4.0/legalcode*](https://creativecommons.org/licenses/by-sa/4.0/legalcode)。

修订记录
| 日期        | 修订版本    | 修改描述                        | 作者   |
| ---------- |  --------  | ------------------------       | ------|
| 2021/09/26 |   1.1.0    | 智能定位（异常检测故障诊断）测试报告 | 朱金龙 |

关键词：Aops 智能定位 异常检测 故障诊断
摘要：按照测试策略，对A-ops项目下的智能定位（异常检测、故障诊断）进行功能、场景以及可靠性测试。
缩略语清单：  
| 缩略语        | 英文全名      | 中文解释       |
| ------------ | ------------ | --------------|
| adoctor-check | adoctor-check-scheduler  | 异常检测调度器安装包 |
| adoctor-check | adoctor-check-executor   | 异常检测执行器安装包 |
| adoctor-diag  | adoctor-diag-scheduler   | 故障诊断调度器安装包 |
| adoctor-diag  | adoctor-diag-executor    | 故障诊断执行器安装包 |


# 1   概述

adoctor-check异常检测模块主要是通过对收集到的集群内机器节点上各类运行数据进行计算与分析，来确认数据项是否存在异常的工具。<br>
异常检测工具依托于aops框架运行，主要分为scheduler和executor两个模块。<br>

adoctor-dig故障诊断模块负责对异常检测的结果进行组合判断，通过树状图的形式分析、展现出可能出现的故障。主要分为两个子模块：<br>
1. 诊断调度器模块：负责响应上层用户发来的restful请求，以及生成诊断消息发入消息队列，供诊断执行器执行相应诊断。<br>
2. 诊断执行器模块：负责从消息队列中消费消息，执行诊断后，将诊断结果存入数据库中。


# 2   特性测试说明

本节描述被测对象的版本信息和测试的时间及测试轮次区，详细的版本信息和测试时间如下表：

| 版本名称             | 测试起始时间   | 测试结束时间   |
| ------------------- | ------------ | ------------ |
| openEuler 21.09 RC1 | 2021-08-16   | 2021-08-27   |
| openEuler 21.09 RC2 | 2021-08-30   | 2021-09-03   |
| openEuler 21.09 RC3 | 2021-09-06   | 2021-09-10   |
| openEuler 21.09 RC4 | 2021-09-13   | 2021-09-15   |
| openEuler 21.09 RC5 | 2021-09-16   | 2021-09-17   |

描述特性测试的硬件环境信息

| 架构    | 环境   | 配置                                 | 数量 |
|:-------|:------|:-------------------------------------|:----|
| arm架构 | 虚拟机 | CPU核数：4<br>内存：4G<br>硬盘容量：50G | 4   |
| x86架构 | 虚拟机 | CPU核数：4<br>内存：4G<br>硬盘容量：50G | 4   |


# 3   测试结论概述

##  3.1 测试整体结论

异常检测特性，共计执行34个用例，覆盖特性的基本功能、可靠性和安全测试。

| 测试活动    | 活动评价                                               |
| ----------| ------------------------------------------------------ |
| 功能测试   | 功能测试符合预期，提供的异常检测功能正常             |
| 可靠性测试 | 覆盖异常操作，启动流程异常，部署业务异常，命令行各选项/参数异常 |
| 安全测试   | 验证安装包内文件权限，符合要求                         |

故障诊断特性，共计执行52个用例，覆盖特性过的基本功能、可靠性和安全测试。

| 测试活动   | 活动评价                                                |
| ---------- | ---------------------------------------------------- |
| 功能测试   | 功能测试符合预期，提供的故障诊断功能正常 |
| 可靠性测试 | 覆盖异常操作，启动流程异常，部署业务异常，命令行各选项/参数异常 |
| 安全测试   | 验证安装包内文件权限，符合要求                          |

##  3.2 约束说明

特性可靠性暂不保证，只需保证基本功能正常

##  3.3 遗留问题分析

### 3.3.1 遗留问题影响以及规避措施

| 序号 | 问题单号 | 问题简述                                                     | 问题级别 | 影响分析          |
| ---- | -------- | --------------------------------------------------------- | -------- | -------------- |
| 1    | I4BY62 | [异常检测规则较多的情况下，时常会造成es数据库崩溃的现象](https://gitee.com/openeuler/A-Ops/issues/I4BY62?from=project-issue) | 中 | 检测规则多，造成日志激增，导致es数据库崩溃 | 挂起 |
| 2    | I4A3TE | [故障诊断报告删除，目前只支持根据report_id去删除，其他方式都不支持](https://gitee.com/src-openeuler/A-Ops/issues/I4A3TE?from=project-issue) | 中 | 删除报告方式单一，只能一个个删除，造成报告数量过多 | 挂起 |
| 3    | I48MYX | [aops group命令中，建议增加指定主机组搜索功能](https://gitee.com/src-openeuler/A-Ops/issues/I48MYX?from=project-issue) | 中 | 当主机组数量较多的情况下，查找不易，影响效率 | 挂起 |


### 3.3.2 问题统计

|        | 问题总数 | 严重 | 主要 | 次要 | 不重要 |
| ------ | --------| ---- | ---- | ---- | ------ |
| 数目    | 43      | 2    | 38   | 3    | 0      |
| 百分比  | 100%    | 4.6% | 88.4% | 7%  | 0      |


# 4   测试执行

##  4.1 测试执行统计数据

*本节内容根据测试用例及实际执行情况进行特性整体测试的统计，可根据第二章的测试轮次分开进行统计说明。*

| 版本名称             | 测试用例数  | 用例执行结果 | 发现问题单数 |
| ------------------- | --------- | ---------- | ---------- |
| openEuler 21.09 RC2 | 86        | failed     | 11         |
| openEuler 21.09 RC3 | 86        | failed     | 10         |
| openEuler 21.09 RC4 | 86        | failed     | 10         |
| openEuler 21.09 RC5 | 86        | failed     | 12         |

*数据项说明：*

*测试用例数－－到本测试活动结束时，所有可用测试用例数；*

*发现问题单数－－本测试活动总共发现的问题单数。*

## 4.2   后续测试建议

后续测试需要关注点(可选)


# 5     附件

*此处可粘贴各类专项测试数据或报告*

