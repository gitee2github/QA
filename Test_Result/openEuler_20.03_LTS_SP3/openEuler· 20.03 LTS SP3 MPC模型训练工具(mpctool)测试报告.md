![avatar](https://gitee.com/openeuler/QA/raw/master/images/openEuler.png)

版权所有 © 2023 openEuler社区 

您对“本文档”的复制、使用、修改及分发受知识共享(Creative Commons)署名—相同方式共享4.0国际公共许可协议(以下简称“CC BY-SA 4.0”)的约束。为了方便用户理解，您可以通过访问[https://creativecommons.org/licenses/by-sa/4.0/](https://gitee.com/link?target=https%3A%2F%2Fcreativecommons.org%2Flicenses%2Fby-sa%2F4.0%2F) 了解CC BY-SA 4.0的概要 (但不是替代)。CC BY-SA 4.0的完整协议内容您可以访问如下网址获取：[https://creativecommons.org/licenses/by-sa/4.0/legalcode。](https://gitee.com/link?target=https%3A%2F%2Fcreativecommons.org%2Flicenses%2Fby-sa%2F4.0%2Flegalcode%E3%80%82)

修订记录

| 日期      | 修订版本 | 修改描述                  | 作者        |
| --------- | -------- | ------------------------- | ----------- |
| 2023-3-15 | 1.0.1    | 增加mpctool兼容性相关描述 | queyanwen   |
| 2023-3-10 | 1.0.0    | 初稿                      | tumingliang |

关键词：MPC；风扇调速；功耗；



摘要：

本报告主要描述基于openEuler 20.03 LTS SP3版本进行的MPC模型训练工具（mpctool）的测试过程，报告对测试情况进行说明，对特性的测试充分度进行评估和总结。 

缩略语清单：

| 缩略语 | 英文全名                        | 中文解释       |
| ------ | ------------------------------- | -------------- |
| MPC    | Model Predictive Control        | 模型预测控制   |
| BMC    | Baseboard Management Controller | 基板管理控制器 |


# 1     特性概述

## 1.1 特性功能

MPC是基于温度预测的风扇转速自适应调优方法，该方法通过对关键部件的温度变化进行预测，提前响应风扇转速，在满足温度约束的情况下，通过调节风扇转速达到整体功率最低，达到节能的目的。使用该功能前或设备发生与热设计相关变更时(比如 添加/拔除硬盘)，需要使用mpctool对MPC预测模型进行训练，并更新模型到BMC中。

mpctool以RPM安装包形式提供（名称：eagle-mpctool），基于python3，以后台服务方式运行。



## 1.2 兼容性策略

mpctool作为通用特性，基于ipmi协议实现，使用ipmitool raw命令发送/接受消息，但MPC相关的ipmi接口均属于扩展接口，如果需要支持MPC特性，则相关设备的BMC需要支持并实现MPC特性相关接口（具体接口可参考源代码）。当前支持MPC功能的设备有：

| 整机型号           | BMC版本         | BIOS版本 |
| ------------------ | --------------- | -------- |
| taishan200-2280 VD | iBMC 3.10.00.01 | 6.38     |



# 2     特性测试信息

## 2.1 测试策略

- mpctool实现主场景为：采集数据=》模型训练=》下发模型到BMC；除此主场景之外，还需考虑采集数据失败、模型训练失败、下发模型失败、设备本身不支持MPC等异常场景测试。

- 经分析，mpctool实现功能不影响系统安全，因而不涉及系统安全性测试。

- 基于mpctool兼容性设计测试，此次测试采用taishan200-2280 VD服务器。



## 2.2 测试计划

| 版本                 | 测试起始时间 | 测试结束时间 |
| -------------------- | ------------ | ------------ |
| mpctool-v1.0.0-beta1 | 2023-3-6     | 2023-3-10    |
| mpctool-v1.0.0-beta2 | 2023-3-13    | 2023-3-15    |



### 2.3 测试环境：

| 硬件型号           | 硬件配置信息 | 备注      |
| ------------------ | ------------ | --------- |
| taishan200-2280 VD | kunpeng 920  | arm服务器 |





# 3     测试结论概述

## 3.1   测试整体结论

针对MPC在线模型训练工具，共计执行7个用例，主要覆盖了功能测试（自动模式以及手动模式下的工作流程），测试过程中未发现问题，无遗留问题风险，整体质量良好：

| 测试活动                | 活动评价                                                     |
| ----------------------- | ------------------------------------------------------------ |
| 功能测试                | 基本功能均已实现，测试结果良好                               |
| DFX（可靠性、资源占用） | 异常处理合理： <br>1）对于不支持该特性的设备，程序执行失败，退出；<br/>2）未安装相关依赖的设备，程序执行失败，退出；<br/>3）资源占用<0.5单CPU，内存占用<50M |
| 收益测试                | 相比不开启MPC功能，开启MPC功能后，使用BenchSEE测试功耗降低15~20W。 |



## 3.2   约束说明

1. mpctool只针对支持MPC特性的服务器，mpctool的运行依赖ipmitool，功能正确执行依赖BMC实现扩展的ipmi raw接口。

2. mpctool采用python3实现，依赖python3解释器，并依赖python3-numpy、python3-pandas、python3-psutil三方库，均是openEuler 20.03-LTS-SP3中已有的组件。

   




## 3.3   遗留问题分析

### 3.3.1 遗留问题影响以及规避措施

无

### 3.3.2 问题统计

无



# 4     测试执行

## 4.1   测试执行统计数据

测试数据：

| 版本名称             | 测试用例数 | 用例执行结果 | 发现问题单数 |
| -------------------- | ---------- | ------------ | ------------ |
| mpctool-v1.0.0-beta1 | 7          | All Pass     | 0            |
| mpctool-v1.0.0-beta2 | 7          | All Pass     | 0            |

## 4.2   后续测试建议



建议在openEuler兼容性清单上的其他机型上进一步进行mpctool工具兼容性验证。



# 5     附件

无



 



 

 